<!-- General Chart-Component to load individual charts -->
<ChartComponent CanvasId="ProteinChart" ChartConfig="@ChartConfig" />

@code {
    //Get Data from main component
    [CascadingParameter(Name = "ProteinPoints")]
    private List<ChartPoint>? ProteinPoints { get; set; } = new();

    private object? ChartConfig { get; set; }

    // Create Chart Config
    protected override void OnInitialized()
    {
        if (ProteinPoints is not null && ProteinPoints.Count > 0)
        {
            // Generate labels based on current time for each data point
            var labels = ProteinPoints.Select(pp => pp.Date.ToString("dd.MM")).ToList();
            var protein = ProteinPoints.Select(pp => pp.Value).ToList();
            var nutritionGoalProtein = ProteinPoints.Select(pp => pp.NutritionGoal).ToList();

            ChartConfig = new
            {
                data = new
                {
                    labels = labels,
                    datasets = new object[]
                    {
                        new {
                             type = "bar",
                            label = "Protein",
                            data = protein,
                            backgroundColor = "rgba(6, 214, 160, 0.6)",
                            borderColor =  "#a2d208",
                        },
                        new {
                            type = "line",
                            label = "Proteinziel",
                            data = nutritionGoalProtein,
                            backgroundColor = "rgba(255, 0, 0, 0.6)",
                            borderColor = "rgba(255, 0, 0, 0.6)",
                        },
                    }
                },
                options = new
                {
                    responsive = true,
                    maintainAspectRatio = false,
                    animation = false,

                    plugins = new
                    {
                        legend = new
                        {
                            display = false,
                        },
                    },

                    scales = new
                    {
                        x = new
                        {
                            grid = new
                            {
                                display = true,
                            },
                        },
                        y = new
                        {
                            beginAtZero = true,
                            title = new
                            {
                                padding = 0,
                                display = true,
                            }
                        }
                    },

                    Interaction = new
                    {
                        mode = "index",
                        axis = "x",
                        intersect = false,
                    },

                    hover = new
                    {
                        mode = "index",
                        intersect = false,
                    }
                }
            };
        }
    }
}